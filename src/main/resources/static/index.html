<html>
<head>
<style>
    * {
        margin: 0;
        padding: 0;
        border: 0;
    }
    #prev {
        display: block;
        position: fixed;
        top: 10vh;
        left: 0;
        width: 10vw;
        height: 90vh;
        background-color: green;
        opacity: .5;
    }
    #next {
        display: block;
        position: fixed;
        top: 10vh;
        right: 0;
        width: 10vw;
        height: 90vh;
        background-color: blue;
        opacity: .5;
    }
    #top {
        display: block;
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 10vh;
        background-color: red;
        opacity: .5;
    }
    p {
        text-align: center;
    }
    img {
        position: fixed;
    }
</style>
<script src="hammer.min.js"></script> 
<script>
    function num(s, def) {
        var patt = /[\-]?[0-9\.]+/
        var match = patt.exec(s)
        if (match != null && match.length > 0) {
            var n = match[0]
            if (n.indexOf('.') > -1) {
                return parseFloat(n)
            } else {
                return parseInt(n)
            }
        }
        return def
    }

    function viewportWidth() {
        return Math.max(document.documentElement.clientWidth, window.innerWidth || 0)
    }
    function viewportHeight() {
        return Math.max(document.documentElement.clientHeight, window.innerHeight || 0)
    }
    function pan(x, y) {
        var img = getImage()
        //console.log(img.style.left)
        //console.log(img.style.top)
        var minimumLeft = Math.min(0, viewportWidth() - img.width)
        var maximumLeft = Math.max(0, viewportWidth() - img.width)
        var minimumTop = Math.min(0, viewportHeight() - img.height)
        var maximumTop = Math.max(0, viewportHeight() - img.height)

        var newLeft = num(img.style.left, 0) + x
        var newTop = num(img.style.top, 0) + y

        //if (newLeft < 0 && (newLeft + img.width < viewportWidth())) newLeft = originalLeft
        if (newLeft < minimumLeft) newLeft = minimumLeft
        if (newLeft > maximumLeft) newLeft = maximumLeft
        if (newTop < minimumTop) newTop = minimumTop
        if (newTop > maximumTop) newTop = maximumTop

        img.style.left = newLeft
        img.style.top = newTop
        //console.log(img.style.left)
        //console.log(img.style.top)

        // regularization
        
    }
    function zoom(d) {
        var img = getImage()
        //console.log(img.width)
        //console.log(img.height)

        // option one:
        //img.width = img.width * d
        
        // option two:
        var newWidth = img.width * d
        var newHeight = img.height * d
        img.width = newWidth
        img.height = newHeight

        //console.log(img.width)
        //console.log(img.height)
    }
    function getImage() {
        return document.getElementsByTagName("img")[0]
    }
    var revertScrollZoom = true
    var scrollSpeed = .5 * .1
    function mouseWheelScroll(i) {
        //console.log(i.deltaY)
        zoom(1 + i.deltaY * scrollSpeed * (revertScrollZoom ? -1 : 1))
    }
    var drag = false;
    function mouseDown(e) {
        e.preventDefault()
        drag = true;
    }
    function mouseUp(e) {
        drag = false;
    }
    var panSpeed = 4
    function mouseMove(e) {
        if (drag) {
            console.log(e.movementX)
            console.log(e.deltaX)
            pan(e.movementX * panSpeed, e.movementY * panSpeed)
        }
    }

    var myOptions = {}
    var hammertime = new Hammer(document, myOptions);
    hammertime.get('pan').set({ direction: Hammer.DIRECTION_ALL, threshold: 0 });

    var touchscreenPanAttenuator = 1
    var panPreviousDeltaX = 0
    var panPreviousDeltaY = 0
    
    hammertime.on('pan', function(ev) {
        //console.log(ev);
        //pan(ev.overallVelocityX * touchscreenPanAttenuator, ev.overallVelocityY * touchscreenPanAttenuator)
        var currentDeltaX = ev.deltaX - panPreviousDeltaX
        var currentDeltaY = ev.deltaY - panPreviousDeltaY
        pan(currentDeltaX * touchscreenPanAttenuator, currentDeltaY * touchscreenPanAttenuator)
        panPreviousDeltaX = ev.deltaX
        panPreviousDeltaY = ev.deltaY
    });
    hammertime.on('panend', function(ev) {
        console.log(ev);
        //pan(ev.deltaX * touchscreenPanAttenuator, ev.deltaY * touchscreenPanAttenuator)
        panPreviousDeltaX = 0
        panPreviousDeltaY = 0
    });

</script>
</head>
<body>
    <img src="comic.jpg" />
    <div id="prev"></div>
    <div id="next"></div>
    <div id="top"></div>
    <script>
        document.addEventListener("wheel", mouseWheelScroll)
        document.addEventListener("mousedown", mouseDown)
        document.addEventListener("mouseup", mouseUp)
        document.addEventListener("mousemove", mouseMove)
    </script>
</body>
</html>