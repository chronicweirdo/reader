<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Comics Reader</title>
    <style>
        h1 {
            margin: .5vw;
        }
        .imgdiv {
            position: relative;
            display: inline-block;
            width: 180px;
            height: 300px;
            overflow: hidden;
            text-decoration: none;
            margin: .5vw;
        }
        .imgdiv img {
            position: relative;
        }
        .imgdiv span {
            position: absolute;
            right: 10px;
            bottom: 10px;
            background-color: white;
            padding: 5px;
        }
    </style>
    <script>
        function scaleImage(image, page) {
            if (page >= 0) {
                var span = document.createElement("span")
                span.innerText = page
                image.parentElement.appendChild(span)
            }
            var imageContainer = document.getElementsByClassName("imgdiv")[0]
            var expectedHeight = imageContainer.offsetHeight
            var expectedWidth = imageContainer.offsetWidth
            if (image.naturalWidth / image.naturalHeight > expectedWidth / expectedHeight) {
                image.style.height = "100%"
            } else {
                image.style.width = "100%"
            }
            var differenceWidth = image.offsetWidth - expectedWidth
            var differenceHeight = image.offsetHeight - expectedHeight
            image.style.left = (- differenceWidth / 2) + "px"
            image.style.top = (- differenceHeight / 2) + "px"
        }
    </script>
</head>
<body>
<p th:text="${user}">user name</p>
<p><a href="/logout">logout</a></p>
<div th:each="collection: ${comicCollections}">
    <h1 th:text="${collection.name}">Collection Name</h1>
    <p>
        <a class="imgdiv" th:each="comic: ${collection.comics}" th:href="'comic?id=' + ${comic.id}">
            <img th:attr="onload='scaleImage(this,' + ${comic.progress} + ')'" th:src="${comic.cover}" th:title="${comic.title}">
        </a></p>
</div>
</body>
</html>